# ðŸ§¬ Craft DNA - Digital Heritage & Provenance System

## Overview

**Craft DNA** is KalpanaAI's revolutionary digital heritage preservation system that creates a permanent, scannable record of every artisan craft's cultural authenticity, origin story, and sustainability impact.

---

## ðŸŽ¯ Purpose

To preserve the cultural authenticity, origin story, and sustainability impact of every artisan craft by generating a unique, scannable QR code that links to a permanent digital record.

---

## âœ¨ Key Features

### 1. **Automatic Heritage Record Generation**
- Triggered automatically during Add Product flow
- Captures artisan's personal story (voice/text)
- Documents craft technique and regional tradition
- Records materials used and cultural context
- Calculates sustainability metrics

### 2. **QR Code Generation**
- Unique QR code for each product
- Embedded in Marketing Kit
- Links to dedicated Craft Heritage Page
- Printable for physical product attachment

### 3. **Digital Heritage Page**
- Artisan video/photo gallery
- High-res craft process images
- Cultural and ritual significance
- Eco-impact statistics
- Artisan's name, village, and craft lineage
- Heritage narrative generated by AI

### 4. **Sustainability Tracking**
- Carbon footprint calculation
- Water usage metrics
- Comparison vs. industrial production
- Renewable materials percentage
- Biodegradability assessment
- Eco-claims validation

### 5. **Cultural Preservation**
- Heritage narrative (300+ words)
- Cultural significance analysis
- Endangered craft status tracking
- UNESCO relevance checking
- Regional tradition documentation

---

## ðŸ”§ Technical Implementation

### Agent Architecture

```python
class CraftDNAAgent:
    - generate_craft_dna()          # Main generation function
    - _generate_heritage_narrative() # AI-powered storytelling
    - _calculate_eco_impact()        # Sustainability metrics
    - _analyze_cultural_significance() # Cultural analysis
    - _generate_qr_code()            # QR code creation
    - generate_printable_heritage_label() # Print-ready label
```

### API Endpoint

```bash
POST /api/craft-dna/generate
```

**Request Parameters:**
```json
{
  "product_id": "PROD12345",
  "artisan_story": "I learned this brass work from my grandfather...",
  "craft_technique": "Jaipur brass casting and etching",
  "regional_tradition": "Rajasthani metalwork",
  "materials": "[\"recycled brass\", \"natural lacquer\", \"beeswax polish\"]",
  "cultural_context": "These diyas are traditionally used during Diwali...",
  "artisan_name": "Ramesh Kumar",
  "artisan_village": "Amber",
  "artisan_state": "Rajasthan",
  "artisan_lineage": "4th generation brass artisan",
  "years_of_experience": 25
}
```

**Response:**
```json
{
  "success": true,
  "craft_dna": {
    "heritage_id": "CDN-PROD12345-20250102153045",
    "heritage_url": "https://kalpana.ai/heritage/CDN-PROD12345-20250102153045",
    "qr_code": {
      "image_base64": "iVBORw0KGgoAAAANS...",
      "url": "https://kalpana.ai/heritage/...",
      "format": "PNG",
      "size": "300x300",
      "printable": true
    },
    "artisan": {
      "name": "Ramesh Kumar",
      "village": "Amber",
      "state": "Rajasthan",
      "lineage": "4th generation brass artisan",
      "personal_story": "..."
    },
    "craft": {
      "technique": "Jaipur brass casting and etching",
      "regional_tradition": "Rajasthani metalwork",
      "materials": ["recycled brass", "natural lacquer", "beeswax polish"],
      "endangered_status": "Active Tradition"
    },
    "heritage_narrative": "In the golden city of Jaipur, where brass artisans have shaped metal for centuries...",
    "cultural_analysis": {
      "historical_origin": "Part of the Rajasthani metalwork tradition...",
      "cultural_rituals": "Used during Diwali festival...",
      "symbolic_meaning": "Represents skilled craftsmanship...",
      "endangered_risk": "Low - Active and thriving",
      "modern_relevance": "Artisans are adapting traditional techniques..."
    },
    "eco_impact": {
      "carbon_footprint": {
        "value": -0.5,
        "unit": "kg COâ‚‚",
        "vs_industrial": "70% less carbon emissions"
      },
      "sustainability_score": 85,
      "eco_claims": [
        "Made with 100% sustainable materials",
        "Uses recycled and upcycled materials",
        "Locally sourced materials reduce transport emissions",
        "ðŸŒ¿ Certified Sustainable Craft"
      ]
    },
    "metadata": {
      "craft_category": "Metalwork",
      "preservation_priority": "MEDIUM - Monitor and support",
      "cultural_heritage_tags": [
        "craft:jaipur_brass_casting",
        "region:rajasthani_metalwork",
        "category:metalwork",
        "handmade",
        "artisan"
      ],
      "unesco_relevant": false
    }
  },
  "printable_label": {
    "format": "PDF",
    "size": "5cm x 5cm",
    "elements": {
      "qr_code": "base64_image_data",
      "title": "Scan to Discover This Craft's Story",
      "artisan_name": "Ramesh Kumar",
      "craft_technique": "Jaipur brass casting and etching",
      "sustainability_score": "85/100"
    }
  },
  "message": "Craft DNA generated successfully - Your craft's story is now permanently preserved!"
}
```

---

## ðŸ“± Frontend Integration

### Add Product Flow Integration

Update `add-product.tsx` to include Craft DNA generation:

```typescript
// Step 1: Collect Craft DNA Information
const [craftDnaData, setCraftDnaData] = useState({
  artisanStory: '',
  craftTechnique: '',
  regionalTradition: '',
  materials: [],
  culturalContext: '',
  artisanProfile: {
    name: '',
    village: '',
    state: '',
    lineage: '',
    yearsOfExperience: 0
  }
});

// Step 2: Generate Craft DNA after product creation
const generateCraftDNA = async (productId: string) => {
  const formData = new FormData();
  formData.append('product_id', productId);
  formData.append('artisan_story', craftDnaData.artisanStory);
  formData.append('craft_technique', craftDnaData.craftTechnique);
  formData.append('regional_tradition', craftDnaData.regionalTradition);
  formData.append('materials', JSON.stringify(craftDnaData.materials));
  formData.append('cultural_context', craftDnaData.culturalContext);
  formData.append('artisan_name', craftDnaData.artisanProfile.name);
  formData.append('artisan_village', craftDnaData.artisanProfile.village);
  formData.append('artisan_state', craftDnaData.artisanProfile.state);
  formData.append('artisan_lineage', craftDnaData.artisanProfile.lineage);
  formData.append('years_of_experience', craftDnaData.artisanProfile.yearsOfExperience.toString());

  const response = await fetch('https://your-api.run.app/api/craft-dna/generate', {
    method: 'POST',
    body: formData
  });

  const result = await response.json();
  return result;
};

// Step 3: Display QR Code in Marketing Kit
<div className="craft-dna-section">
  <h3>ðŸ§¬ Craft DNA - Your Heritage Record</h3>
  <img 
    src={`data:image/png;base64,${craftDna.qr_code.image_base64}`} 
    alt="Craft Heritage QR Code"
    className="qr-code"
  />
  <p>Scan to view: {craftDna.heritage_url}</p>
  <button onClick={() => downloadQRCode()}>
    Download QR Code for Product
  </button>
</div>
```

### UI Components Needed

1. **Craft DNA Form Step** (in Add Product flow)
   - Artisan story input (text/voice)
   - Craft technique dropdown
   - Regional tradition selector
   - Materials multi-select
   - Cultural context textarea
   - Artisan profile fields

2. **QR Code Display**
   - QR code image
   - Heritage URL
   - Download button
   - Print button
   - Share button

3. **Heritage Preview**
   - Mini preview of heritage page
   - Key stats (sustainability score, materials, etc.)
   - "View Full Heritage Page" link

---

## ðŸŽ¨ Heritage Page Design

### URL Structure
```
https://kalpana.ai/heritage/{heritage_id}
```

### Page Sections

1. **Hero Section**
   - Product image
   - Artisan photo/video
   - QR code (scannable)
   - Heritage ID

2. **Artisan Story**
   - Personal narrative
   - Name, village, lineage
   - Years of experience
   - Family craft tradition

3. **Craft Details**
   - Technique explanation
   - Regional tradition
   - Materials used
   - Cultural context

4. **Heritage Narrative** (AI-generated)
   - 300+ word story
   - Historical context
   - Cultural significance

5. **Sustainability Impact**
   - Carbon footprint comparison
   - Water usage savings
   - Eco-claims with badges
   - Sustainability score visualization

6. **Cultural Preservation**
   - Endangered status
   - UNESCO relevance
   - Preservation priority
   - Heritage tags

7. **Call to Action**
   - "Support this artisan"
   - "Learn more about this craft"
   - "Share this story"

---

## ðŸ“¦ Storage Architecture

### Firestore Structure

```javascript
Collection: craft_dna_records
Document ID: {heritage_id}
{
  heritage_id: "CDN-PROD12345-20250102153045",
  product_id: "PROD12345",
  artisan_id: "ART67890",
  created_at: Timestamp,
  updated_at: Timestamp,
  
  artisan: {
    name: "Ramesh Kumar",
    village: "Amber",
    state: "Rajasthan",
    // ... full artisan data
  },
  
  craft: {
    // ... craft details
  },
  
  heritage_narrative: "...",
  cultural_analysis: { ... },
  eco_impact: { ... },
  
  media: {
    qr_code_url: "gs://bucket/qr_codes/...",
    artisan_video_url: "gs://bucket/videos/...",
    craft_images: ["gs://bucket/images/..."]
  },
  
  metadata: {
    views_count: 0,
    shares_count: 0,
    verification_status: "verified"
  }
}
```

### Firebase Storage Structure

```
/craft_dna_media/
  /{heritage_id}/
    /qr_code.png
    /artisan_video.mp4
    /craft_process/
      /image_1.jpg
      /image_2.jpg
    /printable_label.pdf
```

---

## ðŸš€ Deployment Steps

### 1. Install Dependencies

```bash
pip install qrcode[pil]>=7.4.2
```

### 2. Deploy Agent

The Craft DNA Agent is located at:
```
Agents/agents/craft_dna_agent.py
```

Already integrated into main API (`api/main2.0.py`)

### 3. Test Endpoint

```bash
curl -X POST https://your-api.run.app/api/craft-dna/generate \
  -F "product_id=TEST123" \
  -F "artisan_story=My grandfather taught me this craft..." \
  -F "craft_technique=Jaipur brass casting" \
  -F "regional_tradition=Rajasthani metalwork" \
  -F 'materials=["recycled brass", "natural lacquer"]' \
  -F "cultural_context=Used during Diwali festival" \
  -F "artisan_name=Test Artisan" \
  -F "artisan_village=Jaipur" \
  -F "artisan_state=Rajasthan"
```

### 4. Frontend Integration

Add Craft DNA form to Add Product pipeline (Step 4 or 5)

### 5. Deploy Heritage Page

Create Next.js dynamic route:
```
app/heritage/[heritage_id]/page.tsx
```

---

## ðŸ’¡ Use Cases

### For Artisans
âœ… Creates permanent digital archive of craft legacy  
âœ… Validates authenticity and provenance  
âœ… Shares personal story with buyers  
âœ… Documents endangered techniques  
âœ… Proves sustainability claims  

### For Buyers
âœ… Verifies product authenticity  
âœ… Learns human story behind craft  
âœ… Sees environmental impact  
âœ… Connects emotionally with maker  
âœ… Shares heritage with others  

### For Culture
âœ… Prevents cultural erosion  
âœ… Documents endangered techniques  
âœ… Preserves craft knowledge  
âœ… Archives regional traditions  
âœ… Supports UNESCO nominations  

### For Planet
âœ… Validates eco-claims with data  
âœ… Quantifies sustainability impact  
âœ… Promotes conscious consumption  
âœ… Tracks carbon savings  

---

## ðŸ“Š Impact Metrics

Track these metrics for each Craft DNA record:

```javascript
{
  engagement: {
    qr_scans: 0,
    page_views: 0,
    shares: 0,
    time_on_page: 0
  },
  
  impact: {
    artisans_helped: 0,
    crafts_preserved: 0,
    co2_saved_kg: 0,
    water_saved_liters: 0
  },
  
  cultural: {
    endangered_crafts_documented: 0,
    regional_traditions_archived: 0,
    unesco_submissions: 0
  }
}
```

---

## ðŸŽ¯ Future Enhancements

### Phase 2 (Q1 2025)
- [ ] Blockchain integration for immutable records
- [ ] NFT minting for digital heritage
- [ ] Multi-language heritage narratives
- [ ] Video interview capture in app

### Phase 3 (Q2 2025)
- [ ] AR experience (scan QR to see craft process in 3D)
- [ ] Voice-guided heritage tours
- [ ] Community voting on endangered crafts
- [ ] Heritage certification program

### Phase 4 (Q3 2025)
- [ ] Government/UNESCO integration
- [ ] Carbon credit tracking
- [ ] Heritage marketplace
- [ ] Craft lineage tree visualization

---

## ðŸ” Security & Privacy

- âœ… Artisan data stored securely in Firestore
- âœ… Media files in private Firebase Storage buckets
- âœ… QR codes use HTTPS only
- âœ… Heritage pages require authentication (optional)
- âœ… Artisan can update/delete their Craft DNA
- âœ… GDPR compliant data handling

---

## ðŸ“ Documentation

### API Reference
- Endpoint: `/api/craft-dna/generate`
- Method: POST
- Auth: Required (Firebase token)
- Rate limit: 100 requests/hour per artisan

### Agent Reference
- Location: `Agents/agents/craft_dna_agent.py`
- Dependencies: vertexai, qrcode, Pillow
- Model: gemini-2.0-flash-exp

---

## ðŸŽ‰ Tagline

> **"Your craft isn't just a product â€” it's a living story. Craft DNA ensures the world never forgets it."**

---

## ðŸ“ž Support

For integration help:
- Check `/docs` endpoint for API documentation
- Review code examples in this guide
- Test with sample data first
- Monitor Firestore logs for issues

---

**Last Updated:** 2025-01-02  
**Version:** 1.0.0  
**Status:** âœ… Ready for Production
